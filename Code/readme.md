This folded consists of the whole implementaion code.
